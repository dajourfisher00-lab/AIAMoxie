<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Assistant Platform</title>
    <style>
        :root {
            --color-bg-primary: #0f172a;
            --color-bg-secondary: #1e293b;
            --color-bg-tertiary: #334155;
            --color-text-primary: #f1f5f9;
            --color-text-secondary: #cbd5e1;
            --color-accent: #38bdf8;
            --color-accent-hover: #0ea5e9;
            --color-border: rgba(148, 163, 184, 0.2);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--color-bg-primary);
            color: var(--color-text-primary);
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: var(--color-bg-secondary);
            border-bottom: 1px solid var(--color-border);
            padding: 1rem 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .header h1 {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--color-accent);
        }

        .model-selector {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .model-selector label {
            font-size: 0.875rem;
            color: var(--color-text-secondary);
        }

        .model-selector select {
            background: var(--color-bg-tertiary);
            color: var(--color-text-primary);
            border: 1px solid var(--color-border);
            border-radius: 0.5rem;
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
            cursor: pointer;
        }

        .chat-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            max-width: 900px;
            width: 100%;
            margin: 0 auto;
            padding: 2rem;
            overflow: hidden;
        }

        .messages {
            flex: 1;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            padding-bottom: 1rem;
        }

        .message {
            display: flex;
            gap: 1rem;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message.user {
            justify-content: flex-end;
        }

        .message-content {
            background: var(--color-bg-secondary);
            border: 1px solid var(--color-border);
            border-radius: 1rem;
            padding: 1rem 1.25rem;
            max-width: 80%;
            line-height: 1.6;
        }

        .message.user .message-content {
            background: var(--color-accent);
            color: var(--color-bg-primary);
            border: none;
        }

        .message.assistant .message-content {
            background: var(--color-bg-secondary);
        }

        .avatar {
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 1rem;
            flex-shrink: 0;
        }

        .message.user .avatar {
            background: var(--color-accent);
            color: var(--color-bg-primary);
        }

        .message.assistant .avatar {
            background: var(--color-bg-tertiary);
            color: var(--color-accent);
        }

        .input-area {
            background: var(--color-bg-secondary);
            border: 1px solid var(--color-border);
            border-radius: 1rem;
            padding: 1rem;
            display: flex;
            gap: 1rem;
            align-items: flex-end;
        }

        .input-area textarea {
            flex: 1;
            background: var(--color-bg-tertiary);
            color: var(--color-text-primary);
            border: 1px solid var(--color-border);
            border-radius: 0.75rem;
            padding: 0.75rem 1rem;
            font-size: 0.95rem;
            font-family: inherit;
            resize: none;
            min-height: 2.5rem;
            max-height: 8rem;
            line-height: 1.5;
        }

        .input-area textarea:focus {
            outline: none;
            border-color: var(--color-accent);
        }

        .input-area button {
            background: var(--color-accent);
            color: var(--color-bg-primary);
            border: none;
            border-radius: 0.75rem;
            padding: 0.75rem 1.5rem;
            font-weight: 600;
            font-size: 0.95rem;
            cursor: pointer;
            transition: background 0.2s;
            white-space: nowrap;
        }

        .input-area button:hover:not(:disabled) {
            background: var(--color-accent-hover);
        }

        .input-area button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .typing-indicator {
            display: flex;
            gap: 0.4rem;
            padding: 1rem;
        }

        .typing-indicator span {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--color-text-secondary);
            animation: bounce 1.4s infinite ease-in-out;
        }

        .typing-indicator span:nth-child(1) {
            animation-delay: -0.32s;
        }

        .typing-indicator span:nth-child(2) {
            animation-delay: -0.16s;
        }

        @keyframes bounce {
            0%, 80%, 100% {
                transform: scale(0);
            }
            40% {
                transform: scale(1);
            }
        }

        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            text-align: center;
            gap: 1rem;
            color: var(--color-text-secondary);
        }

        .empty-state h2 {
            font-size: 2rem;
            color: var(--color-text-primary);
        }

        .empty-state p {
            font-size: 1rem;
            max-width: 500px;
        }

        .suggestions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 2rem;
            max-width: 600px;
        }

        .suggestion {
            background: var(--color-bg-secondary);
            border: 1px solid var(--color-border);
            border-radius: 0.75rem;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.875rem;
        }

        .suggestion:hover {
            background: var(--color-bg-tertiary);
            border-color: var(--color-accent);
        }

        .settings-panel {
            position: fixed;
            top: 0;
            right: -400px;
            width: 400px;
            height: 100vh;
            background: var(--color-bg-secondary);
            border-left: 1px solid var(--color-border);
            padding: 2rem;
            transition: right 0.3s ease;
            overflow-y: auto;
            z-index: 1000;
        }

        .settings-panel.open {
            right: 0;
        }

        .settings-btn {
            background: transparent;
            border: 1px solid var(--color-border);
            color: var(--color-text-primary);
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            cursor: pointer;
            font-size: 0.875rem;
            transition: all 0.2s;
        }

        .settings-btn:hover {
            border-color: var(--color-accent);
            color: var(--color-accent);
        }

        .settings-group {
            margin-bottom: 1.5rem;
        }

        .settings-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
            color: var(--color-text-secondary);
        }

        .settings-group input {
            width: 100%;
            background: var(--color-bg-tertiary);
            color: var(--color-text-primary);
            border: 1px solid var(--color-border);
            border-radius: 0.5rem;
            padding: 0.75rem;
            font-size: 0.875rem;
        }

        .settings-group input:focus {
            outline: none;
            border-color: var(--color-accent);
        }
    </style>
</head>
<body>
    <header class="header">
        <h1>AI Assistant</h1>
        <div class="model-selector">
            <label for="model">Model:</label>
            <select id="model">
                <option value="gpt-4">GPT-4</option>
                <option value="claude-3.5">Claude 3.5 Sonnet</option>
                <option value="kimi-2.2" selected>Kimi 2.2</option>
                <option value="gemini-pro">Gemini Pro</option>
            </select>
            <button class="settings-btn" onclick="toggleSettings()">‚öôÔ∏è Settings</button>
        </div>
    </header>

    <div class="chat-container">
        <div class="messages" id="messages">
            <div class="empty-state">
                <h2>Welcome to Your AI Assistant</h2>
                <p>Ask me anything. I can help with research, coding, business strategy, or just chat.</p>
                <div class="suggestions">
                    <div class="suggestion" onclick="sendSuggestion('Explain how to build AI agents')">
                        Explain how to build AI agents
                    </div>
                    <div class="suggestion" onclick="sendSuggestion('Help me analyze my business idea')">
                        Help me analyze my business idea
                    </div>
                    <div class="suggestion" onclick="sendSuggestion('Write code for a web scraper')">
                        Write code for a web scraper
                    </div>
                    <div class="suggestion" onclick="sendSuggestion('What are the latest AI trends?')">
                        What are the latest AI trends?
                    </div>
                </div>
            </div>
        </div>

        <div class="input-area">
            <textarea 
                id="userInput" 
                placeholder="Ask anything..."
                rows="1"
                onkeydown="handleKeyDown(event)"
            ></textarea>
            <button id="sendBtn" onclick="sendMessage()">Send</button>
        </div>
    </div>

    <div class="settings-panel" id="settingsPanel">
        <h2 style="margin-bottom: 2rem; color: var(--color-accent);">Settings</h2>
        
        <div class="settings-group">
            <label>API Key</label>
            <input type="password" id="apiKey" placeholder="Enter your API key">
        </div>

        <div class="settings-group">
            <label>API Endpoint</label>
            <input type="text" id="apiEndpoint" placeholder="https://api.example.com">
        </div>

        <div class="settings-group">
            <label>Temperature (0-1)</label>
            <input type="number" id="temperature" value="0.7" min="0" max="1" step="0.1">
        </div>

        <div class="settings-group">
            <label>Max Tokens</label>
            <input type="number" id="maxTokens" value="2048" min="100" max="32000" step="100">
        </div>

        <div class="settings-group">
            <label>Search API Key (optional)</label>
            <input type="password" id="searchApiKey" placeholder="Brave/Serper API key for web search">
        </div>

        <button class="settings-btn" style="width: 100%; margin-top: 1rem;" onclick="saveSettings()">
            Save Settings
        </button>

        <button class="settings-btn" style="width: 100%; margin-top: 0.5rem; background: var(--color-bg-tertiary);" onclick="exportSettings()">
            üíæ Export Settings
        </button>
        
        <button class="settings-btn" style="width: 100%; margin-top: 0.5rem; background: var(--color-bg-tertiary);" onclick="document.getElementById('importFile').click()">
            üì• Import Settings
        </button>
        <input type="file" id="importFile" style="display: none;" accept=".json" onchange="importSettings(event)">

        function saveSettings() {
            const settings = {
                apiKey: document.getElementById('apiKey').value,
                apiEndpoint: document.getElementById('apiEndpoint').value,
                temperature: parseFloat(document.getElementById('temperature').value),
                maxTokens: parseInt(document.getElementById('maxTokens').value)
            };
            
            // Store in memory (in production, use secure storage)
            window.aiSettings = settings;
            
            alert('Settings saved!');
            toggleSettings();
        }

        function saveSettings() {
            const settings = {
                apiKey: document.getElementById('apiKey').value,
                apiEndpoint: document.getElementById('apiEndpoint').value,
                temperature: parseFloat(document.getElementById('temperature').value),
                maxTokens: parseInt(document.getElementById('maxTokens').value),
                searchApiKey: document.getElementById('searchApiKey').value
            };
            
            // Store in localStorage for persistence
            localStorage.setItem('aiSettings', JSON.stringify(settings));
            window.aiSettings = settings;
            
            alert('Settings saved!');
            toggleSettings();
        }

        function exportSettings() {
            const settings = localStorage.getItem('aiSettings');
            if (!settings) {
                alert('No settings to export. Save settings first.');
                return;
            }
            
            const blob = new Blob([settings], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'ai-assistant-settings.json';
            a.click();
            URL.revokeObjectURL(url);
        }

        function importSettings(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const settings = JSON.parse(e.target.result);
                    
                    // Populate form fields
                    document.getElementById('apiKey').value = settings.apiKey || '';
                    document.getElementById('apiEndpoint').value = settings.apiEndpoint || '';
                    document.getElementById('temperature').value = settings.temperature || 0.7;
                    document.getElementById('maxTokens').value = settings.maxTokens || 2048;
                    document.getElementById('searchApiKey').value = settings.searchApiKey || '';
                    
                    // Save to localStorage
                    localStorage.setItem('aiSettings', JSON.stringify(settings));
                    window.aiSettings = settings;
                    
                    alert('Settings imported successfully!');
                } catch (error) {
                    alert('Error importing settings. Please check the file format.');
                }
            };
            reader.readAsText(file);
        }

        // Load settings on page load
        window.addEventListener('DOMContentLoaded', function() {
            const savedSettings = localStorage.getItem('aiSettings');
            if (savedSettings) {
                try {
                    const settings = JSON.parse(savedSettings);
                    window.aiSettings = settings;
                    
                    // Populate form fields
                    document.getElementById('apiKey').value = settings.apiKey || '';
                    document.getElementById('apiEndpoint').value = settings.apiEndpoint || '';
                    document.getElementById('temperature').value = settings.temperature || 0.7;
                    document.getElementById('maxTokens').value = settings.maxTokens || 2048;
                    document.getElementById('searchApiKey').value = settings.searchApiKey || '';
                } catch (error) {
                    console.error('Error loading saved settings:', error);
                }
            }
        });
    </div>

    <script>
        let conversationHistory = [];

        function toggleSettings() {
            const panel = document.getElementById('settingsPanel');
            panel.classList.toggle('open');
        }

        function saveSettings() {
            const settings = {
                apiKey: document.getElementById('apiKey').value,
                apiEndpoint: document.getElementById('apiEndpoint').value,
                temperature: parseFloat(document.getElementById('temperature').value),
                maxTokens: parseInt(document.getElementById('maxTokens').value)
            };
            
            // Store in memory (in production, use secure storage)
            window.aiSettings = settings;
            
            alert('Settings saved!');
            toggleSettings();
        }

        function handleKeyDown(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage();
            }
        }

        function sendSuggestion(text) {
            document.getElementById('userInput').value = text;
            sendMessage();
        }

        async function sendMessage() {
            const input = document.getElementById('userInput');
            const message = input.value.trim();
            
            if (!message) return;

            const messagesContainer = document.getElementById('messages');
            const emptyState = messagesContainer.querySelector('.empty-state');
            if (emptyState) {
                emptyState.remove();
            }

            // Add user message
            addMessage(message, 'user');
            input.value = '';
            input.style.height = 'auto';

            // Disable send button
            const sendBtn = document.getElementById('sendBtn');
            sendBtn.disabled = true;

            // Show typing indicator
            const typingDiv = document.createElement('div');
            typingDiv.className = 'message assistant';
            typingDiv.innerHTML = `
                <div class="avatar">AI</div>
                <div class="message-content">
                    <div class="typing-indicator">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                </div>
            `;
            messagesContainer.appendChild(typingDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;

            // Call actual API
            try {
                const response = await callLLMAPI(message);
                typingDiv.remove();
                addMessage(response, 'assistant');
            } catch (error) {
                typingDiv.remove();
                addMessage(`Error: ${error.message}\n\nTo use real APIs:\n1. Click ‚öôÔ∏è Settings\n2. Add your API key\n3. Try again!`, 'assistant');
            } finally {
                sendBtn.disabled = false;
            }
        }

        function addMessage(text, sender) {
            const messagesContainer = document.getElementById('messages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            
            const avatar = sender === 'user' ? 'You' : 'AI';
            
            messageDiv.innerHTML = `
                <div class="avatar">${avatar}</div>
                <div class="message-content">${escapeHtml(text)}</div>
            `;
            
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;

            conversationHistory.push({ role: sender, content: text });
        }

        async function callLLMAPI(userMessage) {
            const settings = window.aiSettings || {};
            const model = document.getElementById('model').value;
            
            if (!settings.apiKey) {
                throw new Error('API key not configured. Please add it in Settings.');
            }

            // Check if web search is needed
            const needsSearch = /latest|current|news|today|2026|recent|now/i.test(userMessage);
            let searchContext = '';
            
            if (needsSearch && settings.searchApiKey) {
                try {
                    searchContext = await performWebSearch(userMessage, settings.searchApiKey);
                } catch (error) {
                    console.error('Search failed:', error);
                }
            }

            // Build messages with search context
            const messages = conversationHistory.map(msg => ({
                role: msg.role === 'user' ? 'user' : 'assistant',
                content: msg.content
            }));

            if (searchContext) {
                messages.push({
                    role: 'user',
                    content: `Web search results:\n${searchContext}\n\nUser question: ${userMessage}`
                });
            } else {
                messages.push({
                    role: 'user',
                    content: userMessage
                });
            }

            // Call appropriate API based on model
            if (model === 'gpt-4') {
                return await callOpenAI(messages, settings);
            } else if (model === 'claude-3.5') {
                return await callAnthropic(messages, settings);
            } else if (model === 'kimi-2.2') {
                return await callKimi(messages, settings);
            } else if (model === 'gemini-pro') {
                return await callGemini(messages, settings);
            }
        }

        async function performWebSearch(query, apiKey) {
            // Using Brave Search API as example (you can use Serper, Tavily, etc.)
            const response = await fetch('https://api.search.brave.com/res/v1/web/search', {
                method: 'GET',
                headers: {
                    'Accept': 'application/json',
                    'X-Subscription-Token': apiKey
                },
                params: new URLSearchParams({
                    q: query,
                    count: 5
                })
            });

            if (!response.ok) throw new Error('Search failed');
            
            const data = await response.json();
            const results = data.web?.results || [];
            
            return results.map((r, i) => 
                `[${i+1}] ${r.title}\n${r.description}\nURL: ${r.url}`
            ).join('\n\n');
        }

        async function callOpenAI(messages, settings) {
            const response = await fetch('https://api.openai.com/v1/chat/completions', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${settings.apiKey}`
                },
                body: JSON.stringify({
                    model: 'gpt-4',
                    messages: messages,
                    temperature: settings.temperature || 0.7,
                    max_tokens: settings.maxTokens || 2048
                })
            });

            if (!response.ok) {
                throw new Error(`API error: ${response.status}`);
            }

            const data = await response.json();
            return data.choices[0].message.content;
        }

        async function callAnthropic(messages, settings) {
            const response = await fetch('https://api.anthropic.com/v1/messages', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'x-api-key': settings.apiKey,
                    'anthropic-version': '2023-06-01'
                },
                body: JSON.stringify({
                    model: 'claude-3-5-sonnet-20241022',
                    messages: messages,
                    max_tokens: settings.maxTokens || 2048,
                    temperature: settings.temperature || 0.7
                })
            });

            if (!response.ok) {
                throw new Error(`API error: ${response.status}`);
            }

            const data = await response.json();
            return data.content[0].text;
        }

        async function callKimi(messages, settings) {
            const endpoint = settings.apiEndpoint || 'https://api.moonshot.cn/v1/chat/completions';
            
            const response = await fetch(endpoint, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${settings.apiKey}`
                },
                body: JSON.stringify({
                    model: 'moonshot-v1-128k',
                    messages: messages,
                    temperature: settings.temperature || 0.7,
                    max_tokens: settings.maxTokens || 2048
                })
            });

            if (!response.ok) {
                throw new Error(`API error: ${response.status}`);
            }

            const data = await response.json();
            return data.choices[0].message.content;
        }

        async function callGemini(messages, settings) {
            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${settings.apiKey}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    contents: messages.map(m => ({
                        role: m.role === 'assistant' ? 'model' : 'user',
                        parts: [{ text: m.content }]
                    })),
                    generationConfig: {
                        temperature: settings.temperature || 0.7,
                        maxOutputTokens: settings.maxTokens || 2048
                    }
                })
            });

            if (!response.ok) {
                throw new Error(`API error: ${response.status}`);
            }

            const data = await response.json();
            return data.candidates[0].content.parts[0].text;
        }

        function generateResponse(userMessage) {
            const model = document.getElementById('model').value;
            
            // Simulated responses based on keywords
            const lower = userMessage.toLowerCase();
            
            if (lower.includes('agent') || lower.includes('build')) {
                return `Great question about AI agents! To build agents like Clawdbot:\n\n1. Choose a framework (LangChain, AutoGPT, or OpenClaw)\n2. Connect to an LLM API (GPT-4, Claude, or Kimi 2.2)\n3. Define tools and integrations (web, email, calendar)\n4. Implement the agent loop: perceive ‚Üí plan ‚Üí act ‚Üí reflect\n5. Add security controls and monitoring\n\nUsing ${model}, you can create autonomous agents that handle tasks 24/7. Want me to show you specific code examples?`;
            }
            
            if (lower.includes('business') || lower.includes('idea')) {
                return `I can help analyze your business! For the best results, tell me:\n\n‚Ä¢ What problem are you solving?\n‚Ä¢ Who is your target customer?\n‚Ä¢ What's your competitive advantage?\n‚Ä¢ How will you monetize?\n\nBased on your profile, I see you're working on Pegasus (investment ecosystem) and real estate deals. Want to discuss scaling strategies or automation opportunities?`;
            }
            
            if (lower.includes('code') || lower.includes('scraper')) {
                return `Here's a simple web scraper template:\n\n\`\`\`python\nimport requests\nfrom bs4 import BeautifulSoup\n\nurl = "https://example.com"\nresponse = requests.get(url)\nsoup = BeautifulSoup(response.content, 'html.parser')\n\nfor item in soup.find_all('div', class_='item'):\n    print(item.text)\n\`\`\`\n\nFor production use with ${model}, you'd add error handling, rate limiting, and store results in a database. What specific site do you want to scrape?`;
            }
            
            if (lower.includes('trend') || lower.includes('ai')) {
                return `Top AI trends in 2026:\n\n‚Ä¢ Agentic AI - autonomous agents that act on your behalf\n‚Ä¢ Large context windows - models like Kimi 2.2 with 1M+ tokens\n‚Ä¢ Multimodal systems - vision, voice, and text together\n‚Ä¢ Edge AI - running models locally for security\n‚Ä¢ AI infrastructure - Docker, orchestration, and security\n\nFor your business automation goals, agentic AI + infrastructure knowledge is the winning combination. Want to dive deeper into any of these?`;
            }
            
            return `I'm processing your question using ${model}. This is a demo interface - in production, I would:\n\n‚Ä¢ Call the actual API endpoint with your message\n‚Ä¢ Stream the response in real-time\n‚Ä¢ Include web search if needed\n‚Ä¢ Cite sources and provide references\n\nTo make this work for real, you'll need to:\n1. Get API keys for your chosen model\n2. Connect the backend (Node.js, Python, or similar)\n3. Implement proper error handling and streaming\n\nWant me to explain any of these steps in detail?`;
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML.replace(/\n/g, '<br>');
        }

        // Auto-resize textarea
        document.getElementById('userInput').addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = Math.min(this.scrollHeight, 128) + 'px';
        });
    </script>
</body>
</html>
